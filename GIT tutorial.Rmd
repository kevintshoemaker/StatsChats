---
title: "Git tutorial"
author: "Stats Chats and NRES 746"
date: "November 2021"
output: 
  html_document: 
    theme: flatly
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

NOTE: this tutorial borrows from Dr. Jonathan Greenberg's version control workshop for GRAD 778. 

# Git tutorial

Today we will run through a basic version control workflow using three different systems:

1. GitHub.com
2. GitHub desktop
3. command line

## Install key software

1. Please get a GitHub account from: [https://GitHub.com/](https://GitHub.com/). It's free and very easy! 

2. Install GitHub Desktop from [https://desktop.GitHub.com/](https://desktop.GitHub.com/). This is a GUI version of Git that makes it easy to manage repositories that are hosted on GitHub.com. It also contains a command line interface  


## Some definitions

***Git*** *n*. An unpleasant or contemptible person (British slang).

Oops, not that definition. Here are the definitions we are actually working with:

* *Version control*: a system for tracking changes among different versions of a project, branching and merging versions of a project, differentiating between different versions, handling conflicts when merging different versions, reverting to old versions, etc.
* *Repository* (repo): container for all the files and folders in your project. In a typical Git/GitHub workflow, repositories are stored both locally and in the cloud. Version control systems enable tracking, merging, restoring different versions of a repo.
* *Git*: a widely used system for version control.
* *GitHub*: web-based system for storing repositories in the cloud and interfacing with these repositories using the Git version control system.
* *main branch*: the 'official' or 'stable' version of the repository ('main' is the default name for this branch in GitHub) (you will typically have both local and remote copies of the main branch)
* *branching*: creating a new parallel version of the project within the repo ('development branch') that is not yet ready for primetime. You can add to this branch and use it for testing until you feel it's ready to merge it back into the main branch (stable version).  
* *staging*: proposing some new files or edits for version control within a branch of your repo.
* *committing*: making staged changes 'official' (formally add a staged edit or addition to the repository as an official 'version')
* *push*: export any changes you have make within your local repository 'upstream' to the remote copy of the repository.  
* *pull/fetch*: import any new changes that have been made in the remote repo into your local copy of the repository. Pull and fetch are actually a bit different, but in this intro will basically be used interchangeably.
* *origin*: shorthand for the remote version of a Git repository, often stored in GitHub.
* *HEAD*: the most recently committed version of a repo branch
* *cloning*: creating a fresh local copy of a repository from a remote source (usually GitHub).
* *forking*: copying someone else's repository into your own account so you have full edit privileges. (this is specific to GitHub)(you can use this to propose changes to other people's projects)
* *pull request*: asking permission to merge some proposed edits (e.g., in the form of a development branch or fork) into a project- either your own project or someone else's!

Today we'll get started with Git- but of course, there is much more to know about version control and Git!!

## Overview of version control using Git

In a version control system, the *repository* (repo) is basically a container for all the files in a project. The repository can contain code, other text documents, images, really whatever. 

There tends to be a single remote version of the repository. In a GitHub workflow, the remote version of the repository is stored in the cloud through GitHub.com. 

Contributors to a project will *clone* a version of the repository locally (```git clone```), make changes to that repo (```git add```, ```git commit```), and will push those changes to the remote repository (```git push```). Prior to working on a project, users will often pull the latest version from the remote repository to make sure they have any changes that have been made by other project participants (```git pull```). So the typical workflow might look like:

0. Clone the repo (create a local copy; ```git clone```) [only do this the first time]
1. fetch/pull any changes from the remote repository (```git pull```).
2. make and test changes (```git branch```, ```git add```, ```git commit```, ```git merge```)
3. push upstream to the remote repository (```git push```)

![](Git1.png)

![](Git2.png)

## Workflow #1: walk through the basics of Git using GitHub

### Step 1: create an online repository on GitHub.com

1. Sign into [GitHub.com](GitHub.com)
2. At the top right, create a new repo using the plus sign icon
3. Add a short description, and make sure the 'add a README file' box is checked
4. Click "create repository"
5. If you click "code" at the top of the screen you should se a file called "README.md". This is a markdown textfile that you can use to describe your project!  

### Step 2: create a new development branch

We often want to make a branch so that we can test any new code before we commit it to the main trunk (the "main" branch, or trunk, is the 'stable' version). 

To do this in GitHub, Click "Code" at the top of your repo. You will see "main" at the top left. Click that, and in the branch name (labeled "find or create a branch") type "newbranch" and click "Create branch: newbranch from 'main'".  At this point you have created a new branch, but they are identical (since you haven't changed anything). 

### Step 3. make a change to your files and commit to the new branch

We are going to edit the README.md file that was automatically created for you when you made the repo.  Once we do this, we are going to "Commit" the changes which means we are going to create a new version of our file (while preserving the original one). Usually you will edit code in your own developer environment, but we can do simple edits on the GitHub website for now.

1. Click "Code". 
2. Make sure you are in the "readme-edits" branch shown at the top left. If you are still in "main", drop that down and select the "readme-edits" branch:
3. Click the README.md filename, then click the "Edit this file" icon (the little pencil).
4. Make any change to this file. Note that this is a markdown file, so you can create headers, italics etc just like you would with RMarkdown!
5. Once you are done, you are going to save/commit changes (simultaneously for now, when we start doing real coding these will be separate steps). Write something helpful (but short, under 50 characters) in the Commit changes boxes, like "README.md edit to tell the world about myself".  Click "Commit changes".
6. Confirm you are still in the "readme-edits" branch, and click the README.md file.  Check to make sure it has your changes.
7. Now change the branch back to "main".  Check the README.md file again and you should see the original file!  You have preserved both versions of the file!


### Step 4: merge the change back to the main branch

We are going to create a "pull request" to merge our new README.md into the main branch and then merge the pull request into our main branch.

1. At the top of your repo, click "Pull requests".
2. Create a "New pull request". At the top, set the "base" to be "main" and the "compare" to be whatever you named your new branch.
3. Take a look at the comparison.  It should show additions and subtractions from the original README.md. 
4. Click "Create pull request".  
5. Title your pull request and write a description of the changes, e.g. "Wrote a header in markdown". 
6. Click "Create pull request".
7. Now we'll merge the changes.  Start by clicking the "Pull requests" at the top.  You will see your pull request show up.  Click it.
8. Click "Merge pull request", and then "Confirm merge".
9. Now that a merge has occurred, it is good practice to delete the branch.  You can always create a fresh branch for new features.  Do this now, "Delete branch".


## Workflow #2: version control using GitHub desktop

0. Open GitHub Desktop, and configure with your GitHub account info. (you only need to do this once) 
1. In GitHub.com, click on the green 'Code' button and select "Open with GitHub Desktop". This will clone your repository to a default location such as Documents/GitHub/<repo name>. Alternatively, you could have cloned the repo from GitHub Desktop: File >> Clone repository. 
2. Find your local working directory for the repository. Make sure the README.md is in there!
3. Create a new textfile in your working directory- for example, a file with the .R extension. You could go ahead and create a new R project in this directory!
4. Go back to GitHub Desktop, and make sure the new changes appear in the lefthand panel. 
5. In the lower left, type a name for your commit, and then press the button "Commit to main". 
6. In the top banner, click on "Push origin"

Note that every time you start working on a collaborative project, you will probably want to click on "Fetch origin" at the top to make sure you're working with the most recent version. Also, this includes projects where you are collaborating with yourself- that is, working from several different computers, each with its own local version of the repo. 


## Workflow #4: version control with Git command line and GitHub CLI

GitHub Desktop is great and all, but if you want to use Git you should have a basic knowledge of the Git command line. So let's run this as well!

Here are some of the basic Git commands:
* *Git status*   - check to see if there are unstaged or staged changes to the local respository. Always good to run before doing anything!
* *Git log* - inspect previous commits. 
* *Git checkout* - switch between different branches of a repository.
* *Git clone* - fetch materials from a remote repository.  


### Step 1: clone your repository locally.



Click on [this link](https://try.GitHub.io) to access a basic tutorial on the Git command line.

Much more information can be found [here](https://Git-scm.com/)

### Step 1: Get Git!!

The easiest way to do this is to download the [GitHub desktop software](https://desktop.GitHub.com/)

This should download the Git desktop software AND the Git bash emulator for windows (if you want to use the command line!).

NOTE: you can set the directory location for 'Git.exe' in your environment variables, and then you can access Git from any command shell!

### Step 1: Get GitHub!

If you don't already have a GitHub account, go to [GitHub.com](GitHub.com)


### Git tutorial #2: this time it's for real!

The easiest way to create a new repository is through the GitHub desktop software. So that's what we will do first.

1. Go to [GitHub](GitHub.com) and log in. 
2. Open GitHub desktop and sign in. You only have to do this once- next time you open GitHub desktop it will remember you!
3. Create a new directory on your computer to hold a local copy of a new GitHub repository. Name the repository "Tutorial"

NOTE: I have a Git directory on my computer where all my local Git repositories live...  I use something like 

```
C:\Git
```

You can do whatever you want though!

4. Go to GitHub desktop and click on the 'plus' sign in the upper left corner. Go to the 'add' tab and browse to the new folder you created. This tells GitHub desktop that you want to create a new repository in this directory. 

5. Navigate to the new repository in the left hand menu on GitHub desktop. Click on it. Then click on the 'Publish' button (top right corner of the window). This will create a new cloud-based repository on GitHub.com that will store all the content of your new repository. Go to GitHub.com to make sure your new repository is there.

NOTE: you could have created the repository online and then 'cloned' it to create a local repository on your computer. To do this on the command line: open the Git shell, navigate to your local repository directory, and use the following command (e.g.):

```
Git clone 'https://GitHub.com/kevintshoemaker/Tutorial.Git'
```

Aside from creating a directory through GitHub desktop, this is the easiest way to set up a local Git repo!

6. Add a new text file to the repository. Call it 'README.md'. This is a standard markdown-format textfile that GitHub will use to describe the repository to visitors. Open the textfile in a text editor. You can write anything you want in this file, using pandoc markdown format. For example:

```
## Git Tutorial

This is from the 'stats chats' Git tutorial in April 2017

For more information, go to [the statschats website](kevintshoemaker.GitHub.io/statschats)

```

7. Go back to GitHub desktop, and click on the "changes" tab. You should see your new file in there! 

8. At the bottom of the GUI, you should see a window called "Summary". This is where you describe the changes you have made. Once you write something in there you should see that the "Commit" button at the bottom becomes available to you. Click on that button. 

9. Now that you have a committed change, it's time to push that change up to the GitHub repository. Click the "sync" button at the top. Now you have committed AND pushed your changes!



#### Undoing a commit

Sometimes something may go terribly wrong with a commit. For example, you accidentally commit a file that is too big to store in Git (100 MB- this has happened to me several times)

1. Git commit -m "Something terribly misguided"     [this is you making a terrible error]         
2. Git reset HEAD~1                [this undoes the commit by reverting to the previously committed version]                                
 

10. Let's add another file to the repository. This time it is an R file. Let's call it "test.R".

11. Open up a shell (command) window. The easiest way is to use the Git shell (on windows, may be called 'Git Bash'). Make sure that the shell recognizes the "Git" command by typing "Git" at the prompt and hitting enter.

12. Change the working directory of the shell window to your local Git repository. 

13. Let's first add the new file (i.e., a snapshot of your current file) to the staging area. Use the command "Git add"

```
Git add 'test.R'
```

Alternatively, you could use the wildcard function to add all R files:

```
Git add '*.R'
```

14. Now commit the new file (that is, a snapshot of your current file) to your local repository. To do this use the command "Git commit". Remember that all commits must be associated with a message indicating the purpose of your commit. This is helpful when lots of collaborators are working on the project, or if you want to revert to a previous commit. Use the following syntax:

```
Git commit -m "added new R file!"
```

15. Now you can push the file up to the repository:

```
Git push -u origin master
```

Now that you used the -u command, you can push to the repository simply by using "Git push".

NOTE: this was particularly easy because we already configured the "tutorial" folder to be a local Git repository, and Git already knows the location of the cloud-based repository on GitHub. 

If we wanted to set up a local Git repository from scratch, there are a few additional steps...

### Setting up a Git repository

1. The first thing we need to do is create a new directory. We can call it "tutorial 2". 

2. Open your Git shell and navigate to this repository.

3. Initialize the new Git repository. For this just use the command:

```
Git init
```

4. Configure your new Git repository. 


### Conflicts!!

GitHub Desktop does not currently have features for resolving conflicts. And conflicts WILL happen in any kind of collaborative coding project. So you need to know how to deal with this possibility. 
A good tutorial on resolving conflicts can be found [here](https://gist.GitHub.com/karenyyng/f19ff75c60f18b4b8149).

To resolve conflicts you can use the following command:

```
Git mergetool
```





### Other topics

* Forking repositories
* Contributing to existing GitHub sites
* Working with RStudio and Git
* Websites in GitHub


## Resources

For more info on branches and merges, take a look at [this informative post](https://longair.net/blog/2009/04/16/git-fetch-and-merge/)



### If you want to avoid GitHub Desktop...

Some folks just like command line (terminal) better, and just don't want the GUI functionality. Here are some installation instructions for those people!

Install Git and GitHub Command Line Interface (CLI). Git contains the base command-line functionality for version control, and GitHub CLI makes it easier to work with a respository that is hosted on GitHub. Note that GitHub Desktop already contains a version of Git but it's easier if you install it separately for command line usage- sorry!
    a. Windows:   
        - Install Git: https://Git-scm.com/downloads (use installation defaults)
        - Install GitHub CLI: https://GitHub.com/cli/cli/releases/tag/v2.2.0
            - You probably want the "gh_2.2.0_windows_amd64.msi" version

    b. Mac:
        - We are going to do this using "HomeBrew" to do our installations. If you've already installed HomeBrew previously, you don't need to do this step. 
        - Please first install HomeBrew by opening Terminal and:
    
        ```
          /bin/bash -c "$(curl -fsSL https://raw.GitHubusercontent.com/Homebrew/install/HEAD/install.sh)"
        ```
        - If it asks you for a password, this is your local Mac password.
        - Next, update Homebrew:
        
        ```
        brew update
        ```
        - If you get an error, try running these lines:
        
        ```        
        Git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow
        Git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask fetch --unshallow
        brew update
        ```
        - Now install Git and GitHub CLI:
                
        ```
        brew install Git
        brew install gh
        ```
    c. Other OSs: Please check: [https://GitHub.com/cli/cli#installation](https://GitHub.com/cli/cli#installation)

 





























